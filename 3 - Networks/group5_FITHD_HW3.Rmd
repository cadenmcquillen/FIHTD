---
title: "group5_FIHTD_HW3"
author: "Caden McQuillen, Yuchen Sun, Xiang (Jennie) Li"
date: '2023-03-20'
output:
  html_document:
    toc: yes
---


## Libraries
```{r message=FALSE}
library(tidyverse)
library(ggplot2)
```

## 1. The human diseasome

### 1.1 Load expression data
```{r}
data <- load("Diseasome_preprocessed.Rdata")
diseasome
```

The data frame `diseasome` is the Human Diseasome in __edge list__ format (the first two columns are indices into the disease and gene list, respectively). How many diseases and genes are in the Diseasome? How many edges do you see?

```{r}
num_diseases <- length(unique(diseasome[,1]))
num_genes <- length(unique(diseasome[,2]))
num_edges <- nrow(diseasome)

cat("num diseases:", num_diseases, "\n")
cat("num genes:", num_genes, "\n")
cat("num edges:", num_edges, "\n")
```


### 1.2
Transform the loaded edge list into a matrix, where rows correspond to diseases, columns to genes, and an entry to whether an edge exists between the respective disease and gene. What are the dimensions of the matrix?

```{r}
# Create a sparse matrix 
diseasome_mat <- sparseMatrix(
                      i=diseasome[,1], j=diseasome[,2], # disease indices & gene indices
                      dims=c(max(diseasome[,1]), max(diseasome[,2])),
                      dimnames=list(unique(diseasome[,1]), unique(diseasome[,2])))

diseasome_matrix <- as.matrix(diseasome_mat)

dim(diseasome_matrix)
```


### 1.3 Generate HDN
Generate the Human Disease Network (HDN, Figure 1 in Goh et al.) by multiplying the matrix with its own transpose, see lecture. What are the dimensions of the HDN matrix? What are the numeric values in the matrix?

```{r}
hdn <- t(diseasome_mat) %*% diseasome_mat
hdn_matrix <- as.matrix(hdn)
dim(hdn)
```

### 1.4 Visualize the HDN
In addition, show a detailed subnetwork of your choice.

```{r}
library(igraph)

# Create a graph object from the HDN matrix
hdn_graph <- graph.adjacency(hdn_matrix, weighted=TRUE, mode="upper")

# Set vertex labels to disease names
V(hdn_graph)$label <- V(hdn_graph)$name

# Set vertex size based on degree
V(hdn_graph)$size <- degree(hdn_graph)

# Set edge color based on weight
E(hdn_graph)$color <- rgb(0,0,0,alpha=0.5*E(hdn_graph)$weight/max(E(hdn_graph)$weight))

# Plot the graph
plot(hdn_graph, layout=layout_with_fr)
```



## 2. Pathway GGMs

```{r}
data <- load("QMDiab_preprocessed_data_withggm.Rdata")
```


## 3. Phenotype-driven module identification
