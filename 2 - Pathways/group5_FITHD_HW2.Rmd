---
title: "group5_FIHTD_HW2"
author: "Caden McQuillen, Yuchen Sun, Xiang (Jennie) Li"
date: '2023-02-12'
output:
  html_document:
    toc: yes
---


##Libraries
```{r}
library(tidyverse)
```

## Enrichment Analysis

### Load expression data
```{r}
data <- load("geod33272.rda")

```
### KEGG pathways
```{r}
num_kegg_pathways <- length(kegg)
print(paste0("The total number of pathways: ", num_kegg_pathways))

TCA_cycle_genes <- kegg$`hsa00020 Citrate cycle (TCA cycle)`
num_TCA_cycle_genes <- length(TCA_cycle_genes)

print(paste0("The total number of genes in TCA cycle pathway: " , num_TCA_cycle_genes))
```

### Gene X Pathway matrix
```{r}
#vectorize kegg pathways into 1 vector
vectorized_kegg <- unlist(kegg)
#Get unique genes of all pathways
unique_genes <- unique(vectorized_kegg)

#Get gene names of every gene in any pathway
Entrez_names <- subset(geod33272$ID, geod33272$ID$entrezID %in% unique_genes)

#create Gene by Pathway matrix (Genes are columns, Pathway are rows)
Genes_Pathway_Matrix <- matrix(nrow = length(kegg), ncol = length(Entrez_names$agilentID))
colnames(Genes_Pathway_Matrix) <- Entrez_names$agilentID
rownames(Genes_Pathway_Matrix) <- names(kegg)

for (i in 1:length(kegg)){
  currentPathway <- unlist(kegg[i])
  genes <- Entrez_names[Entrez_names$entrezID  %in%  currentPathway,]
  Genes_Pathway_Matrix[i,]  <- colnames(Genes_Pathway_Matrix) %in% genes$agilentID
}



```

